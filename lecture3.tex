%% -*- coding:utf-8 -*-
\chapter{Finite fields. Separability, perfect fields}
We recall the construction and basic properties of finite fields. We
prove that the multiplicative group of a finite field is cyclic, and
that the automorphism group of a finite field is cyclic generated by
the Frobenius map. We introduce the notions of separable (resp. purely
inseparable) elements, extensions, degree. We briefly discuss perfect
fields.

\section{An example (of extension)s. Finite fields}

\begin{corollary}
  \mynameref{def:algebraicclosure} of $K$ is unique up to
  \mynameref{def:isomorphism} of K-algebras
  \footnote{
    There is a redefinition of corollary
    \ref{col:algebraic_closure_isomorphism}.
  }
  \label{col:lec3_1}
\end{corollary}

\begin{corollary}
  Any \mynameref{def:algebraicextension} of $K$ embeds  (see
  definition \ref{def:embedding}) into the
  \mynameref{def:algebraicclosure} \footnote{
    i.e. $\forall E$ - algebraic extension of $K$,
    $\exists \phi: E \to \bar{K}$ - \mynameref{def:homomorphism}. The
    statement is  a reformulation
    of theorem \ref{thm:lec2_3}}
  \label{col:lec3_2}
\end{corollary}

\begin{example}[Of extension of homomorphism]
  Let $K = \mathbb{Q}$ and $\overline{\mathbb{Q}}$ is the
  \mynameref{def:algebraicclosure} of $K$. For instance we can consider
  $\overline{\mathbb{Q}} \subset \mathbb{C}$.
  \footnote{
    Really $\overline{\mathbb{Q}} = \mathbb{A}$ - the set of all algebraic
    numbers, i.e. roots of polynomials $P \in
    \mathbb{Q}\left[X\right]$.
  }

  Let
  \[
  L = \mathbb{Q}\left(\sqrt{2}\right) =
  \mathbb{Q}\left[X\right]/\left(X^2 - 2\right),
  \]
  $\alpha$ is a \mynameref{def:class} of $X$ in $L$. $L$ has 2
  \mynameref{def:embedding}s into 
  $\overline{\mathbb{Q}}$
  \begin{enumerate}
  \item $\phi_1: \alpha \to \sqrt{2}$
  \item $\phi_2: \alpha \to -\sqrt{2}$
  \end{enumerate}

  Let
  \[
  M = \mathbb{Q}\left(\sqrt[4]{2}\right) =
  \mathbb{Q}\left[Y\right]/\left(Y^4 - 2\right),
  \]
  $\beta$ is a \mynameref{def:class} of $Y$ in $M$. $M$ has 4
  \mynameref{def:embedding}s into 
  $\overline{\mathbb{Q}}$
  \begin{enumerate}
  \item $\psi_1: \beta \to \sqrt[4]{2}$ (extends $\phi_1$)
  \item $\psi_2: \beta \to -\sqrt[4]{2}$ (extends $\phi_1$)
  \item $\psi_3: \beta \to i\sqrt[4]{2}$ (extends $\phi_2$)
  \item $\psi_4: \beta \to -i\sqrt[4]{2}$ (extends $\phi_2$)
  \end{enumerate}
  This (``extends'') is because
  \footnote{
    I.e. in our case we have $\mathbb{Q} \subset L \subset M$. We have
    $\phi_{1,2} : L \to \overline{\mathbb{Q}}$ which can be extended
    (accordingly theorem \ref{thm:lec2_3}) to
    $\psi_{1,2,3,4} : M \to \overline{\mathbb{Q}}$
  }
  \[
  M = L\left[Y\right]/\left(Y^2 - \alpha\right) 
  \]
  \label{ex:homomorphismext}
\end{example}

\subsection{Finite fields}

\begin{definition}[Finite field]
  $K$ is a finite field if it's \mynameref{def:fieldcharacteristic}
  $char K = p$, where $p$  
  - prime number 
  \label{def:finitefield}
\end{definition}

\begin{remark}[$\mathbb{F}_{p^n}$]
  If $K$ is a finite extension of $\mathbb{F}_p$
  \footnote{
    i.e. $\left[K:\mathbb{F}_p\right] < \infty$
  }
  and
  $n = \left[K:\mathbb{F}_p\right]$ then number of elements of $K$:
  $\left|K\right| = p^n$. The following notation is also used for a
  finite extension of a finite field: $\mathbb{F}_{p^n}$
  \footnote{
    As we know $\mathbb{F}_p = \mathbb{Z}/p \mathbb{Z}$. From other
    side $\mathbb{F}_{p^n} \ne \mathbb{Z}/p^n \mathbb{Z}$.
    For example $\mathbb{F}_4 \ne \mathbb{Z}/4 \mathbb{Z}$ because
    $\mathbb{Z}/4 \mathbb{Z}$ is not a field ($2 \cdot 2 = 0$
    i.e. zero divisors exist). You have to look at example
    \ref{ex:F2overP} to see exact structure of $\mathbb{F}_4$.
  }
  \label{rem:fpn}
\end{remark}

\begin{remark}[Frobenius homomorphism]
  If $char K = p$, then exists a \mynameref{def:homomorphism}
  $F_p: K \to K$ such that $F_p\left(x\right) = x^p$.
  Really if we consider $\left(x+y\right)^p$ and $\left(xy\right)^p$
  then we can get $\left(x+y\right)^p = x^p + y^p$
  \footnote{
    \[
    \left(x+y\right)^p = \sum_{k=0}^p {p \choose k} x^k y^{p-k}  =
    x^p + y^p + p \cdot \left( \sum_{k=1}^{p-1} a_k x^k y^{p-k} \right),
    \]
    where $a_k \in \mathbb{Z}$. I.e.
    \[
    \left(x+y\right)^p \equiv    
    \left(x^p + y^p\right)  \mod p
    \]    
  }
  and
  $\left(xy\right)^p = x^p y^p$. The second property is the truth in
  the all fields (of course) but the first one is the special property
  of $\mathbb{F}_p$ fields.
  \label{rem:frobeniushomomorphism}
\end{remark}

\begin{remark}
  Also $F_{p^n} : K \to K$ such that $F_{p^n}\left(x\right) = x^{p^n}$
  is also homomorphism (a power of \mynameref{rem:frobeniushomomorphism}.
  \label{rem:frobeniuspowerhomomorphism})
\end{remark}

\section{Properties of finite fields}

\begin{theorem}
  Lets fix $\mathbb{F}_p$ and it's \mynameref{def:algebraicclosure}
  $\overline{\mathbb{F}_p}$.

  The \mynameref{def:splittingfield} of $x^{p^n} - x$ has $p^n$
  elements. Conversely any field of $p^n$ elements is a splitting
  field of $x^{p^n} - x$. Moreover there is an unique sub extension of
  $\overline{\mathbb{F}_p}$ with $p^n$ elements.
  \begin{proof}
    Note that $F_{p^n} : x \to x^{p^n}$ is a
    \mynameref{def:homomorphism} (see remark
    \ref{rem:frobeniuspowerhomomorphism}) as result the following set
    $\{
    x \mid F_{p^n}\left(x\right) = x
    \}$ is a field containing $\mathbb{F}_p$
    \footnote{
      For $x \in \mathbb{F}_p^{\times} = \mathbb{F}_p \setminus \{0\}$ we
      have that (see theorem \ref{thm:abelianelement})
      \[
      x^{\left|\mathbb{F}_p^{\times}\right|} = x^{p-1} = 1
      \]
      and therefore $\forall x \in \mathbb{F}_p: x^p = x$ ($x = 0$
      also satisfied the equation). We can continue as follows
      \begin{eqnarray}
        x^{p^2} = \left(x^p\right)^p = x^p = x,
        \nonumber \\
        x^{p^3} = \left(x^{p^2}\right)^p = x^p = x
        \nonumber \\
        \dots
        \nonumber \\
        x^{p^n} = \left(x^{p^{n-1}}\right)^p = x^p = x
        \nonumber
      \end{eqnarray}
      and finally get
      $F_{p^n}\left(x\right) = x$.
      Thus $\forall x \in \mathbb{F}_p$ we also have
      $x \in \{
      x \mid F_{p^n}\left(x\right) = x
      \}$
    }
    i.e.
    \[
    \mathbb{F}_p \subset
    \left\{
    x \mid F_{p^n}\left(x\right) = x
    \right\}
    \]
    or, in other words, the considered set is a \mynameref{def:fextension1} of
    $\mathbb{F}_p$.
    
    If $Q_n\left(X\right) = X^{p^n} - X$ then the considered set
    consists of the root of the polynomial $Q_n$. The polynomial has
    no multiple roots because $gcd(Q_n, Q_n') = 1$.
    \footnote{
      If $Q_n$ has a multiple root $\beta$ then it is divisible by
      $\left(X - \beta\right)^2$ and the $Q_n'$ is divisible by (at
      least) $\left(X - \beta\right)$ thus the $\left(X -
      \beta\right)$ should be a part of gcd.
    }
    This is because $Q_n' \equiv 1 \mod p$.
    \footnote{
      Really we have the following one $Q_n' = p^n X^{p^n - 1} - 1
      \equiv -1 \mod p$ but the sign is not really matter because
      $\gcd\left(Q_n, -1\right) = \gcd\left(Q_n, 1\right) = 1$. 
    }
    As soon as $Q_n$ has no multiple roots then there are $p^n$
    different roots and therefore the splitting field is the field
    with $p^n$ elements.

    Conversely lets $\left|K\right| = p^n$ and
    $\alpha \ne 0 \in K$.
    Using the fact that the multiplication group of $K$ has $p^n - 1$
    elements: $\left|K^\times\right| = p^n - 1$
    \footnote{
      $K^\times = K \setminus \{0\}$
    }
    as result the multiplication of all the elements should give us
    $1$: $\alpha^{p^n-1} = 1$ or $\alpha^{p^n} - \alpha = 0$
    (see theorem \ref{thm:abelianelement}).
    Therefore $\alpha$ is a root of $Q_n$. Thus the splitting field of
    $Q_n$ consists of elements of $K$.

    The uniqueness
    \footnote{
      up to \mynameref{def:isomorphism}
    }
    of sub-extension of
    $\mathbb{F}_p$ with $p^n$ elements is a result of uniqueness of
    the splitting field (see theorem \ref{thm:lec2_1}). 
  \end{proof}
  \label{thm:lec3_1}
\end{theorem}

\begin{theorem}
  $\mathbb{F}_{p^d} \subset \mathbb{F}_{p^n}$ if and only if $d \mid n$. 
  \begin{proof}
    Let $\mathbb{F}_{p^d} \subset \mathbb{F}_{p^n}$ in this case
    $\mathbb{F}_p \subset \mathbb{F}_{p^d} \subset \mathbb{F}_{p^n}$
    and
    \[
    \left[\mathbb{F}_{p^n}:\mathbb{F}_{p}\right] =
    \left[\mathbb{F}_{p^n}:\mathbb{F}_{p^d}\right]
    \left[\mathbb{F}_{p^d}:\mathbb{F}_{p}\right]
    \]
    or $n = x \cdot d$ i.e. $d \mid n$

    Conversely if $d \mid n$ then $n = x \cdot d$ or
    $p^n = \prod^x_{i=1} p^d$ thus if $x^{p^d} = x$ then
    \[
    x^{p^n} = x^{\prod^x_{i=1} p^d}
    \left(x^{p^d}\right)^{\prod^x_{i=2} p^d} = x^{\prod^x_{i=2} p^d} =
    \dots = x^{p^d} = x,
    \]
    i.e. $\forall \alpha \in \mathbb{F}_{p^d}$ we also have
    $\alpha \in \mathbb{F}_{p^n}$ or in other notation:
    $\mathbb{F}_{p^d} \subset \mathbb{F}_{p^n}$.
  \end{proof}
  \label{thm:lec3_1_2}
\end{theorem}

\begin{theorem}
  $\mathbb{F}_{p^n}$ is a \mynameref{def:stemfield} and a
  \mynameref{def:splittingfield} of any \mynameref{def:irreducible}
  $P \in \mathbb{F}_p$ of degree $n$.
  \begin{proof}
    \mynameref{def:stemfield} $K$ has to have degree $n$ over
    $\mathbb{F}_p$ i.e.
    $\left[K:\mathbb{F}_p\right] = n$ (see remark \ref{rem:lec2_1})
    i.e. it should have $p^n$
    elements (see remark \ref{rem:fpn})
    and therefore $K=\mathbb{F}_{p^n}$
    (see theorem \ref{thm:lec3_1}).

    About \mynameref{def:splittingfield}. Using the just proved result
    we can say that if $\alpha$ is a root of $P$
    then $\alpha \in \mathbb{F}_{p^n}$ thus
    $Q_n\left(\alpha\right) = 0$. Therefore $P$ divides $Q_n$ 
    \footnote{as soon as any root of $P$ also a root of $Q_n$} and as
    result $P$ splits in $\mathbb{F}_{p^n}$.
  \end{proof}
  \label{thm:lec3_1_3}
\end{theorem}

\begin{corollary}
  Let $\mathcal{P}_d$ is the set of all irreducible,
  \mynameref{def:monicpolynomial}s of degree $d$ such that
  $\mathcal{P}_d \subset \mathbb{F}_p\left[X\right]$ then 
  \[
  Q_n = \prod_{d \mid n} \prod_{P \in \mathcal{P}_d} P
  \]
  \begin{proof}
    As we just seen if $P \in \mathcal{P}_d$ and $d \mid n$ then
    $P \mid Q_n$.
    \footnote{
      Since stem field is $\mathbb{F}_{p^d} \subset \mathbb{F}_{p^n}$
      (see theorem \ref{thm:lec3_1_2} and proof at the theorem
      \ref{thm:lec3_1_3}) 
    }
    Since all such polynomials are relatively prime of course
    \footnote{
      As soon as $\mathbb{F}_p\left[X\right]$ is \mynameref{def:ufd}
      then any polynomial can be written as a product of irreducible
      elements, uniquely up to order and units this means that each
      $P \in \mathcal{P}_d$ (where $d \mid n$) should be in the
      factorization of $Q_n$. It should be only one time because there
      is no multiply roots. 
    }
    \footnote{
      We also can say that 2 irreducible polynomial
      $P_1, P_2 \in \mathbb{F}_p\left[X\right]$ should not have same
      roots. For example if $\alpha$ is the same root - it cannot be
      in $\mathbb{F}_p$ because in the case the polynomials will be
      reducible. Thus it can be only in an extension of $\mathbb{F}_p$
      from other side $gcd(P_1,P_2) = 1$ and therefore with
      \mynameref{lem:bezout} one can get that $\exists Q,R \in
      \mathbb{F}_p\left[X\right]$ such that
      \(
      P_1 Q + P_2 R = 1
      \) and setting $\alpha$ into the equation leads to fail
      statement that $0 = 1$.
      }
    and $Q_n$ have no multiple roots (as result no multiple factors) 
    then
    \[
    \left(\prod_{d \mid n} \prod_{P \in \mathcal{P}_d} P \right)\mid Q_n
    \]

    From other side let $R$ is an irreducible factor of $Q_n$.
    $\alpha$ is a root of $R$ then $Q_n\left(\alpha\right) = 0$ thus
    $\mathbb{F}_p\left(\alpha\right) \subset \mathbb{F}_{p^n}$.
    From remark \ref{rem:lec2_1} we have
    \[
    \left[\mathbb{F}_p\left(\alpha\right) : \mathbb{F}_p\right] = \deg
    R = d.
    \]
    From remark \ref{rem:fpn}
    $\mathbb{F}_p\left(\alpha\right) = \mathbb{F}_{p^d}$.
    Theorem \ref{thm:lec3_1_2} says that $d \mid n$.
    As result $R \in \mathcal{P}_d$. Thus the 
    polynomial should be in the product
    $\prod_{d \mid n} \prod_{P \in \mathcal{P}_d} P$.
  \end{proof}
\end{corollary}

\begin{example}
  Let $p = n = 2$. The monic irreducible polynomials in $\mathbb{F}_2$
  whose degree divides $2$ are: $X$, $X+1$ and $X^2 +X + 1$.
  As you can see
  \begin{equation}
    X\left(X+1\right)\left(X^2+X+1\right) = X^4 + X = X^4 - X
    \nonumber
  \end{equation}
  because $2x = 0 \mod 2$ or $x = -x$.
  \label{ex:lec3_ex1}
\end{example}

Just another example \cite{bib:KeithConradFiniteFields}
\footnote{
  There is not a part of the video lectures
}
\begin{example}[Polynomial factorization over a finite field]
  \label{ex:lec3_polfactorization}
  In $\mathbb{F}_2\left[X\right]$, the irreducible factorization of
  $X^{2^n} -X$ for $n=1,2,3,4$ is as follows
  \begin{eqnarray}
    X^2 -X = X \left(X-1\right),
    \nonumber \\
    X^4 -X = X \left(X-1\right)\left(X^2 + X + 1\right),
    \nonumber \\
    X^8 -X = X \left(X-1\right)\left(X^3 + X + 1\right)
    \left(X^3 + X^2 + 1\right),
    \nonumber \\
    X^{16} -X = X \left(X-1\right)\left(X^2 + X + 1\right)
    \nonumber \\
    \left(X^4 + X + 1\right)\left(X^4 + X^3 + 1\right)
    \left(X^4 + X^3 + X^2 + X + 1\right).
    \nonumber
  \end{eqnarray}

  You can compare the example with example \ref{ex:lec3_ex1} but you
  have to take into consideration the following fact
  $1 = -1 \mod 2$
\end{example}

\begin{gapexample}[Polynomial factorization over a finite field in GAP]
  At the moment GAP provides only methods to factorize polynomials
  over finite fields, over subfields of cyclotomic
  fields, and over algebraic extensions of these \cite{bib:gap}.
  
  There is an example of such factorization in
  $\mathbb{F}_2\left[X\right]$ similar to \autoref{ex:lec3_polfactorization}
  \begin{verbatim}  
    gap> x:=Indeterminate(GF(2),"x");;
    gap> Factors(x^8-x);
    [ x, x+Z(2)^0, x^3+x+Z(2)^0, x^3+x^2+Z(2)^0 ]
    gap> x:=Indeterminate(GF(2),"x");;
    gap> Factors(x^2-x);
    [ x, x+Z(2)^0 ]
    gap> Factors(x^4-x);
    [ x, x+Z(2)^0, x^2+x+Z(2)^0 ]
    gap> Factors(x^8-x);
    [ x, x+Z(2)^0, x^3+x+Z(2)^0, x^3+x^2+Z(2)^0 ]
    gap> Factors(x^16-x);
    [ x, x+Z(2)^0, x^2+x+Z(2)^0, x^4+x+Z(2)^0, x^4+x^3+Z(2)^0, 
      x^4+x^3+x^2+x+Z(2)^0 ]
    gap>
  \end{verbatim}
\end{gapexample}


\section{Multiplicative group and automorphism group of a finite
  field}
\begin{theorem}
  Let $K$ be a field and and $G$ be a finite \mynameref{def:subgroup} of
  $K^\times$ (see definition \ref{def:multiplicativegroup}) then $G$
  is a \mynameref{def:cyclicgroup}
  \footnote{
    Not every finite group is cyclic. For instance the non-abelian
    group $S_3$ (see example \ref{ex:s3group}) consists of 6 elements
    but it is not cyclic.

    If we want to have a cyclic group it should be
    \mynameref{def:abeliangroup} in the case it can be represented in
    the form of a cyclic group or a direct sum of cyclic groups
    accordingly \mynameref{thm:fgagroup}. Another important requirement
    is that the orders of the cyclic group have to be coprime.

    For example there are 2 groups of order 4:
    the cyclic one - $\mathbb{Z}/4\mathbb{Z}$ and $V_4$ -
    Klein four group $V_4$ \cite{wiki:klein4group}.
    $V_4 = \mathbb{Z}/2\mathbb{Z} \oplus \mathbb{Z}/2\mathbb{Z}$ is
    non-cyclic because the orders are not coprime: $gcd(2,2) = 2 \ne
    1.$  

    (From the staff) But a product of two
    cyclic groups is 
    again cyclic, if their orders are coprime. For example, consider
    the element $\left(1,1\right) \in \mathbb{Z}/2\mathbb{Z} \times
    \mathbb{Z}/3\mathbb{Z}$. It's order is 6, so it generates the 
    whole group. Thus as it's mentioned
    $\mathbb{Z}/N\mathbb{Z}$ is a cyclic group.
  }
  \begin{proof}
    Idea is to compare $G$ and the \mynameref{def:cyclicgroup}
    $\mathbb{Z}/N\mathbb{Z}$ where $N = \left|G\right|$.
    \footnote{
      We also will use the fact that any cyclic group of order $N$ is
      isomorphic to $\mathbb{Z}/N\mathbb{Z}$
    }

    Let $\psi\left(d\right)$ - is the number of elements of order $d$
    ( see also \mynameref{def:grouporder}) in $G$. We need
    $\psi\left(N\right) \ne 0$
    \footnote{
      In this case we will have at least one element $x$ of order $N$
      i.e. $N$ different elements of $G$ is generated by the $x$
      i.e. the $G$ is cyclic.
    }
    and we know that
    $N = \sum \psi\left(d\right)$.
    
    Let also $\phi\left(d\right)$ - is the number of elements of order $d$
    ( see also \mynameref{def:grouporder}) in $\mathbb{Z}/N\mathbb{Z}$.
    \footnote{      
      The function $\phi\left(d\right)$ is also called as
      \mynameref{def:eulerfuction}
      and it 
      counts the positive integers up to a given integer $d$ that are
      relatively prime to $d$ 
    }
    As $\mathbb{Z}/N\mathbb{Z}$ contains a single (cyclic) subgroup of
    order $d$ for each $d \mid N$.
    \footnote{
      The one generated by $N/d$. Let $N = r \cdot d$ in the case
      $x^N = 1$ there $x$ is a $\mathbb{Z}/N\mathbb{Z}$ group
      generator. From other side
      \[
      x^N = x^{r \cdot d} = \prod_{i=1}^r x^d
      \]
      thus $x^d = 1$ i.e. there is a cyclic subgroup of order $d$.
    }
    $\phi\left(d\right)$ is the number of generators of
    $\mathbb{Z}/d\mathbb{Z}$ i.e. the number of elements between $1$
    and $d-1$ that are prime to $d$. We know that
    $\phi\left(N\right) \ne 0$.

    We claim that either $\psi\left(d\right) = 0$ or
    $\psi\left(d\right) = \phi\left(d\right)$
    \footnote{
      suffices since $\sum \psi\left(d\right) = \sum
      \phi\left(d\right) = N$
    }
    If no element of order $d$ in $G$ then $\psi\left(d\right) = 0$
    otherwise if $x \in G$ has order $d$ then $x^d = 1$ or $x$ is a
    root of the following polynomial $x^d - 1$. The roots of the
    polynomial forms a cyclic subgroup of $G$ (by
    \mynameref{def:cyclicgroup} definition).
    So $G$ as well as
    $\mathbb{Z}/N\mathbb{Z}$ has a single cyclic subgroup of order
    $d$ (which is cyclic) or no such group at all.
    \footnote{
      Several comments about the subgroup. There is a group
      because multiplication of any elements is in the set. It's
      cyclic because it's generated by one element.
      All $x^i$ where $i \le d$ are different (in other case the group
      should have an order less than $d$). Each element of the group
      $x^i$ is a root of $x^d - 1$ because $(x^i)^d = (x^d)^i = 1^i =
      1$. And the group is unique as well as we have $d$ different
      roots of $x^d-1$ in the group. 
    }

    
    If $\psi\left(d\right) \ne 0$ then exists such a subgroup and
    $\psi\left(d\right)$ is equal to the number of generators of that
    group or $\phi\left(d\right)$
    \footnote{
      Because the group is cyclic and any cyclic group is isomorphic
      to $\mathbb{Z}/d\mathbb{Z}$ and as result has the same number of
      generators. 
    }
    In particular $\psi\left(d\right) \le \phi\left(d\right)$
    \footnote{
      because $\psi\left(d\right) = 0$ or
      $\psi\left(d\right) = \phi\left(d\right)$
    }
    but there should be equality because the sum of both $\sum
    \psi\left(d\right) = \sum \phi\left(d\right) = N$.
    In particular $\psi\left(N\right) \ne 0$ and we proved the
    theorem.
  \end{proof}
  \label{thm:lec3_2}
\end{theorem}
\begin{corollary}
  If $\mathbb{F}_p \subset K$ and
  $\left[K:\mathbb{F}_p\right] = n$ then $\exists \alpha$ such that
  $K = \mathbb{F}_p\left(\alpha\right)$. In particular $\exists$ an
  \mynameref{def:irreducible} of degree $n$ over $\mathbb{F}_p$
  \footnote{
    The theorem \ref{thm:lec3_1_3} and remark \ref{rem:fpn} says that
    the stem field for any 
    polynomial of degree $n$ over $\mathbb{F}_p$ exists and there is
    $\mathbb{F}_{p^n}$ and
    $\left[\mathbb{F}_{p^n}:\mathbb{F}_{p}\right] = n$ i.e.
    $K = \mathbb{F}_{p^n}$.
    But we had not proved yet that an
    irreducible polynomial of degree $n$ exists.
  }
  \begin{proof}
    We can take $\alpha = \mbox{ generator of } K^\times$
    \footnote{
      This is because from theorem \ref{thm:lec3_2}
      $K^\times = \left<\alpha\right>$ i.e. any element of $K$ except $0$
      can be got as a power of $\alpha$. Moreover $\alpha \notin
      \mathbb{F}_p$ (in other case we will got $K = \mathbb{F}_p$)
      i.e. we really got  
      $K = \mathbb{F}_p\left(\alpha\right)$.
      $\alpha$ is an \mynameref{def:algebraicelement} because we can
      consider
      $1, \alpha, \dots, \alpha^{n-1}$
      as a basis and $\alpha^n$ can be represented via
      the basis. I.e. $\exists P \in \mathbb{F}_p\left[X\right]$ such
      that $P\left(\alpha\right) = 0$.
      By lemma \ref{lem:minpolynomial} 
      there exists an irreducible polynomial
      $P_{min}\left(\alpha, \mathbb{F}_p\right)$.
      }
  \end{proof}
  \label{cor:lec3_1}
\end{corollary}

\begin{corollary}
  The group of automorphism of $\mathbb{F}_{p^n}$ over
  $\mathbb{F}_{p}$ is cyclic and generated by Frobenius map:
  $F_p: x \to x^p$
  (see remark \ref{rem:frobeniushomomorphism} where we showed that the
  Frobenius map is a field automorphism) 
  \label{cor:lec3_2}
  \begin{proof}
    As we know from theorem \ref{thm:lec3_1}:
    $\forall x \in \mathbb{F}_{p^n}: x^{p^n} = x$ so
    \footnote{
      because
      \[
      \left(F_p\right)^n\left(x\right) =
      \left(F_p\right)^{n-1}\left(F_p\left(x\right)\right) =
      \left(F_p\right)^{n-1}\left(x^p\right) = \dots = x^{p^n} = x
      \]
    }
    $F_p^n = id$. As result the order of $\left<F_p\right>$ is no
    greater than $n$. Lets prove that the $ord F_p = n$.
    Really if $m < n$ then
    $x^{p^m} - x =0$ has $p^m < p^n$ roots and
    \footnote{
      because operates only with $p^m$ elements i.e. not of all
      elements of $\mathbb{F}_{p^n}$.
    }
    $F_p^m$ cannot be identity.
    Finally (from corollary \ref{cor:lec3_1} ) we have
    $\mathbb{F}_{p^n} = \mathbb{F}_p\left(\alpha\right)$ where
    $\alpha$ is a root of an irreducible polynomial of degree
    $n$. I.e. there cannot be more than $n$ automorphism
    \footnote{
      Each automorphism converts the root $\alpha$ into another one
      of $n$ roots of the irreducible polynomial
    }
    so 
    \[
    \left|
    Aut\left(
    \mathbb{F}_{p^n}/\mathbb{F}_{p}
    \right)
    \right| \le n
    \]
    and as we have $n$ of them (\mynameref{def:automorphism}s)
    \footnote{
      We have $n$ different elements of cyclic group
      $\left<F_p\right>$. The generator of the group is an
      automorphism and as result each of $n$ elements is also an
      automorphism. 
    }
    then
    \[
    \left|
    Aut\left(
    \mathbb{F}_{p^n}/\mathbb{F}_{p}
    \right)
    \right| = n
    \]
    and the group is cyclic generated by $F_p$.
  \end{proof}
\end{corollary}

\section{Separable elements}
\label{sec:lec3_separable_elements}
Let $E$ is a \mynameref{def:splittingfield} of an irreducible polynomial
$P$. We would like to say that it ``has many
\mynameref{def:automorphism}s''. What does this mean? This means the
following thing:
Let $\alpha$ and $\beta$ be 2 roots of $P$ then we have 2 extensions
$K\left(\alpha\right) \subset E$ and 
$K\left(\beta\right) \subset E$.

There exists an \mynameref{def:isomorphism} (see proposition
\ref{prop:stemfield}) over $K$
\[
\phi: K\left(\alpha\right) \to K\left(\beta\right)
\]
that is also extended to an \mynameref{def:automorphism} on $E$
(see theorem \ref{thm:isomorphismextension}).

There is one problem with it: is that truth that an irreducible
polynomial of degree $n$ has ``many'' i.e. exactly $n$ ( it cannot
have more than $n$) roots.

The answer is yes if $char K = 0$, but not always if $char K = p$
(where $p$ is a prime number). $P$ can have multiple roots in the case
i.e. $gcd(P, P') \ne 1$.

Why it's not a case for $char K = 0$ - it is because
$\deg P' < \deg P$ and $P \nmid P'$ for $P' \ne 0$ (non constant
polynomial)
\footnote{
  Let $P$ has multiply roots. As soon as it's irreducible a multiply
  root is in an extension of $K$. In this case the root should be also
  a root for $P'$ thus by lemma \ref{lem:minpolynomial} (or
  theorem \ref{thm:irreduciblediv}) one can get
  that $P \mid P'$ in $K\left[X\right]$ but that is impossible because
  $\deg P' < \deg P$ and can be only possible if $P' = 0$.
}

But for $char K = p$ there can be a case when $P' = 0$ for a non
constant polynomial thus $P \mid P'$ and as result $gcd(P, P') = P$.
The $P' = 0$ i.e. it vanishes $P$ is a polynomial in $X^p$. I.e. if
$P = \sum a_i x^i$ and $p \mid i$ or $a_i = 0$. In that case ($P' =
0$) let $r = \max h$ such that $P$ is a polynomial in $X^{p^h}$ that
is $a_i = 0$ whenever $p^h \nmid i$. See the following example
\footnote{
  The example is not a part of the video lectures.
}
\begin{example}
  Let $p = 2$. The polynomial $P\left(X\right) = X^{16} + 1$ has the
  required property ($P' = 0$). The polynomial can be present in the
  following form
  \[
  P\left(X\right) = X^{2^4} + 1 = Q(Y)
  \]
  where $Y = X^{16}$ and $Q(Y) = Y + 1$. In the case
  $r=4, p^r = 16 \mid 16$

  For polynomial $P\left(X\right) = X^{12} + 1$ we have
  \[
  P\left(X\right) = \left(X^{2^2}\right)^3 + 1 = Q(Y)
  \]
  where $Y = X^4$ and $Q(Y) = Y^3 + 1$. In the case
  $r=2, p^2 = 4 \mid 12$ because $h = 3 > 2$ does not fit into
  the requirements: $p^h = 2^3 = 8 \nmid 12$.
\end{example}

\begin{proposition}
  Let $P\left(X\right) = Q\left(X^{p^r}\right)$ and $Q' \ne 0$ i.e.
  $gcd(Q, Q') = 1$ then $Q$ does not have multiple roots but
  all roots of $P$ have multiplicity $p^r$.
  \begin{proof}
    If $\lambda$ is a root of $P$ then $\lambda$:
    $P(X) = (X - \lambda)R$
    Thus $\mu = \lambda^{p^r}$ is the root of $Q$
    \footnote{
      $Q\left(\mu\right) = Q\left(\lambda^{p^r}\right) =
      P\left(\lambda\right) = 0$
    }
    as result
    $Q(Y) = (Y - \lambda^{p^r}) S(Y)$ therefore
    \[
    P(X) =
    \left(X^{p^r} - \lambda^{p^r}\right)S\left(X^{p^r}\right) =
    \left(X - \lambda\right)^{p^r}S\left(X^{p^r}\right)
    \]
    and $\lambda$ is not a root of $S\left(X^{p^r}\right)$.
    \footnote{
      This is because $Q$ does not have multiply roots and as result
      $\mu = \lambda^{p^r}$ is not a root of $S$ or in other words
      $S\left(X^{p^r}\right)_{X=\lambda} \ne 0$
      }
    Thus we just got that multiplicity of $\lambda$ is $p^r$.
  \end{proof}
  \label{prop:lect3_1}
\end{proposition}

\begin{definition}[Separable polynomial]
  $P\in K\left[X\right]$ irreducible polynomial is called separable if
  $\gcd\left(P, P'\right) = 1$
  \label{def:separablepolynomial}
\end{definition}

\begin{definition}[Degree of separability]
  $d_{sep}(P) = \deg Q$ (as above)
  \footnote{    
    It requires some explanation compare to that one was got on the
    lecture video.
    If $P$ is a \mynameref{def:separablepolynomial} then
    $d_{sep}(P) = \deg P$. In other case $P$ should be represented as
    $P\left(X\right) = q_1(X^p)$. If $q_1\left(Y\right)$ is separable
    than $Q = q_1$ otherwise we continue and represent
    $q_1\left(X\right) = q_2\left(X^p\right)$. We should stop on some
    $q_r$ for which we will have $Q = q_r$ and $P\left(X\right) =
    Q\left(X^{p^r}\right)$. In the case $d_{sep}(P) = \deg Q$.
  }
  \label{def:degsep}
\end{definition}

\begin{definition}[Degree of inseparability]
  $d_{i}(P) = \frac{\deg P}{\deg Q}$ ( $=p^r$ in proposition
  \ref{prop:lect3_1})  
  \label{def:deginsep}
\end{definition}

\begin{definition}[Pure inseparable polynomial]
  $P$ is pure inseparable if $d_i = \deg P$.
  Then $P = X^{p^r} - a$
  \footnote{
    In the case $\deg Q = 1$ i.e. $Q\left(Y\right) = Y- a$ or
    $P = X^{p^r} - a$.
  }
  \label{def:deginseppol}
\end{definition}

\begin{definition}[Separable element]
  Let $L$ be an \mynameref{def:algebraicextension} of $K$ then $\alpha \in L$ is
  called separable(inseparable) if it's
  \mynameref{def:minpolynomial} $P_{min}\left(\alpha, K\right)$ has
  the property.
  Note: the separable element is also \mynameref{def:algebraicelement}
  because it has minimal polynomial.
  \label{def:degsepelem}
\end{definition}

\begin{proposition}[On number of homomorphisms]
  If $\alpha$ is separable on $K$ then the number of
  \mynameref{def:homomorphism}s over $K$ from $K$ to $\bar{K}$
  \[
  \left|Hom_K\left(K\left(\alpha\right), \bar{K}\right)\right| =
  \deg P_{min}\left(\alpha, K\right)
  \]
  in general
  \[
  \left|Hom_K\left(K\left(\alpha\right), \bar{K}\right)\right| =
  d_{sep} P_{min}\left(\alpha, K\right)
  \]  
  \begin{proof}
    It's obvious because $d_{sep}$ is the number of distinct roots.
  \end{proof}
  \label{prop:lec3_2}
\end{proposition}

\section{Separable degree, separable extensions}

We want to generalize the proposition \ref{prop:lec3_2} for any field
extension (not necessary $K\left(\alpha\right)$).
Let $L$ be a finite extension of $K$

\begin{definition}[Separable degree]
  $\left[L:K\right]_{sep} = \left|Hom_K\left(L, \bar{K}\right)\right|$  
  \label{def:separabledegree}
\end{definition}

As we know if $L = K\left(\alpha\right)$ then
\mynameref{def:separabledegree} is a number of distinct roots of
minimal polynomial $P_{min}\left(\alpha, K\right)$

\begin{definition}[Separable extension]
  $L$ is separable over $K$ if
  $\left[L:K\right]_{sep} = \left[L:K\right]$
  \label{def:separableextension}
\end{definition}

\begin{definition}[Inseparable degree]
  \[
  \left[L:K\right]_i =
  \frac{\left[L:K\right]}{\left[L:K\right]_{sep}}
  \]
  \label{def:inseparabledegree}
\end{definition}

\begin{theorem}[About separable extensions]
  \begin{enumerate}
  \item If $K \subset L \subset M$ then
    $\left[M:K\right]_{sep} = \left[M:L\right]_{sep}
    \left[L:K\right]_{sep}$
    and $M$ is \mynameref{def:separableextension} over $K$ if and only
    if $M$ is separable over $L$ and $L$ is separable over $K$
  \item The following things are equivalent
    \begin{enumerate}
    \item $L$ is separable over $K$ \label{thm:lec3_3:itm:1}
    \item $\forall \alpha \in L$ $\alpha$ \mynameref{def:degsepelem}
      over $K$ \label{thm:lec3_3:itm:2}
    \item $L$ is generated over $K$ by a finite number of
      \mynameref{def:degsepelem}s i.e.
      $L = K\left(\alpha_1, \alpha_2, \dots, \alpha_n\right)$, there
      $\alpha_i$ is separable over $K$
      \label{thm:lec3_3:itm:3}
    \item   $L = K\left(\alpha_1, \alpha_2, \dots, \alpha_n\right)$, there
      $\alpha_i$ is separable over
      $K\left(\alpha_1, \alpha_2, \dots, \alpha_{i-1}\right)$
      \label{thm:lec3_3:itm:4}
    \end{enumerate}
  \end{enumerate}
  \begin{remark}
    That holds if we replace separability with pure inseparability.
  \end{remark}
  \label{thm:lec3_3}
  \begin{proof}
    About 1st part:
    If we have a \mynameref{def:homomorphism} $\phi: L \to \bar{K}$ then
    it is extended to $\tilde{\phi}: M \to \bar{K}$ (by extension
    theorem \ref{thm:lec2_3}) it can be done with one way per each
    homomorphism from $L$ to $M$ i.e. it can be done by
    $\left|Hom_L\left(M, \bar{K}\right)\right|$ ways but we have
    \[
    \left|Hom_L\left(M, \bar{K}\right)\right| =
    \left|Hom_L\left(M, \bar{L}\right)\right| = \left[M:L\right]_{sep}
    \]
    because $\bar{K}$ is also
    $\bar{L}$ (\mynameref{def:algebraicclosure} over $L$) thus for the
    total number of homomorphisms one can get the following 
    equations 
    \begin{eqnarray}
      \left[M:K\right]_{sep} = 
      \left|Hom_K\left(M, \bar{K}\right)\right| =
      \left|Hom_K\left(L, \bar{K}\right)\right|
      \left|Hom_L\left(M, \bar{K}\right)\right| =
      \nonumber \\
      \left|Hom_K\left(L, \bar{K}\right)\right|
      \left|Hom_L\left(M, \bar{L}\right)\right| =
      \left[M:L\right]_{sep} \left[L:K\right]_{sep}
      \nonumber
    \end{eqnarray}

    We have the following inequality
    \footnote{
      The inequality can be proved by induction using the fact that
      it's true for $K\left(\alpha\right)$ because from general case
      of proposition \ref{prop:lec3_2} 
      \[
      \left|Hom_K\left(K\left(\alpha\right), \bar{K}\right)\right| =
      d_{sep} P_{min}\left(\alpha, K\right) \le
      \deg P_{min}\left(\alpha, K\right) =
      \left[K\left(\alpha\right): K \right]
      \]
      Then let it was proved for $E = K\left(\alpha_1, \dots,
      \alpha_{n-1}\right)$ and we want to prove it for
      $K\left(\alpha_1, \dots,
      \alpha_{n-1}, \alpha_n\right) = E\left(\alpha_n\right)$.
      It's easy because $\bar{E} = \bar{K}$  and we can use the same
      approach as for the first induction step.
    }
    \begin{equation}
      \left[E:K\right]_{sep} \le \left[E:K\right].
      \label{eq:sepineq}
    \end{equation}

    With the inequality (\ref{eq:sepineq}) we also have
    \begin{eqnarray}
    \left[M:K\right]_{sep} = 
    \left[M:L\right]_{sep} \left[L:K\right]_{sep} \le
    \left[M:L\right] \left[L:K\right] = \left[M:K\right]
    \nonumber
    \end{eqnarray}
    The equality is possible if
    $\left[M:L\right]_{sep} = \left[M:L\right]$ and 
    $\left[L:K\right]_{sep} = \left[L:K\right]$ i.e. if
    $M$ is separable over $L$ and $L$ is
    separable over $K$.
    This finishes the proof of the first part.
    
    About 2d part:

    \ref{thm:lec3_3:itm:1} $\Rightarrow$ \ref{thm:lec3_3:itm:2}:
    Part 1 implies that a separable sub extension
    $K\left(\alpha\right)$ or a separable extension $L$ is separable.
    \footnote{
      I.e. in the case we have $K \subset K\left(\alpha\right) \subset
      L$ and if $L$ is separable then $K\left(\alpha\right)$ is
      separable and as result $\alpha$ is a
      \mynameref{def:degsepelem} because $P_{min}\left(\alpha, K\right)$
      is separable.
    }
    
    \ref{thm:lec3_3:itm:2} $\Rightarrow$ \ref{thm:lec3_3:itm:3}:
    obvious
    \footnote{
      We consider finite extensions (see remark \ref{rem:fpn})
      i.e. which consists of finite number of elements
    }

    \ref{thm:lec3_3:itm:3} $\Rightarrow$ \ref{thm:lec3_3:itm:4}:
    We know that
    $P_{min}\left(\alpha_i, K\left(\alpha_1, \dots,
    \alpha_{i-1}\right)\right)$ divides
    $P_{min}\left(\alpha_i, K\right)$.
    \footnote{
      Let $K\left(\alpha_1, \dots, \alpha_{i-1}\right) = L$
      then $K \subset L$ and
      $P_{min}\left(\alpha_i, K\right) \in L\left[ X \right]$
      From other side $P_{min}\left(\alpha_i, L\right)$ is the minimal
      irreducible polynomial  in $L\left[X\right]$ and any other
      polynomial with $\alpha_i$ as root has to by divisible by it
      (see also lemma \ref{lem:minpolynomial}).
    }
    Thus if 
    $P_{min}\left(\alpha_i, K\right)$ is separable (i.e. have distinct
    roots) then it's divisor $P_{min}\left(\alpha_i, K\left(\alpha_1, \dots,
    \alpha_{i-1}\right)\right)$ also should have distinct roots i.e.
    $\alpha_i$ is a \mynameref{def:degsepelem} over
    $K\left(\alpha_1, \dots,\alpha_{i-1}\right)$
    
    \ref{thm:lec3_3:itm:4} $\Rightarrow$ \ref{thm:lec3_3:itm:1}:
    Induction as above
    \footnote{
      The first induction step is trivial: $L=K\left(\alpha\right)$
      where $\alpha$ is separable over $K$ in this case
      $K\left(\alpha\right)$ is also separable.
      Now we have that $\forall k < n$:
      if $L = K\left(\alpha_1, \alpha_2, \dots, \alpha_k\right)$, there
      $\alpha_i$ is separable over
      $K\left(\alpha_1, \alpha_2, \dots, \alpha_{i-1}\right)$ then $L$
      is separable over $K$. Thus we have
      $K\left(\alpha_1, \alpha_2, \dots, \alpha_{n-1}\right)$
      separable and $\alpha_n$ is separable over $K\left(\alpha_1,
      \alpha_2, \dots, \alpha_{n-1}\right)$ thus using the first part
      of the theorem we can conclude that 
      $K\left(\alpha_1, \alpha_2, \dots, \alpha_{n}\right)$ is also
      separable over $K$
    }    
  \end{proof}
\end{theorem}

What's about not finite extension? For that case we can define
separable extension as follows.
\begin{definition}[Separable closure]
  If $L$ over $K$ not necessary finite (but algebraic over $K$) we can
  define
  \[
  L^{sep} = \left\{x \vert x \mbox{ separable over } K \right\}
  \]
  $L^{sep}$ is a sub extension
  \footnote{
    $K \subset L^{sep} \subset L$
  }
  called separable closure of $K$ over
  $L$
  \label{def:separableclosure}
\end{definition}
$L$ is pure inseparable over $L^{sep}$.

\begin{remark}
  \begin{enumerate}
  \item If $char K = 0$ then any extension of $K$ is separable
  \item If $char K = p$ then pure inseparable extension has degree
    $p^r$ and always degree of inseparability
    $\left[L:K\right]_i = p^r$
  \end{enumerate}
\end{remark}

\section{Perfect fields}

\begin{definition}[Perfect field]
  Let $K$ is a field and $char K = p > 0$. $K$ is perfect if
  \mynameref{rem:frobeniushomomorphism} is a \mynameref{def:surjection}
  \label{def:perfectfield}
\end{definition}

\begin{example}
  \begin{enumerate}
    \item Finite field is perfect because an \mynameref{def:injection}
      of a set into itself is always a \mynameref{def:surjection}
    \item Algebraically closed fields are perfect because
      $X^p - a$ has a root $\alpha$ for any $a$ particularly
      $a = F_p\left(\alpha\right)$
      \footnote{
        $\alpha^p -a =0$ as soon as $\alpha$ is a root of $X^p - a$.
        Thus $a = \alpha^p = F_p\left(\alpha\right)$.
      }
    \item Not perfect field example. Let
      $K=\mathbb{F}_p\left(X\right)$ be a field of rational fractions
      in 1 variable over $\mathbb{F}_p$. I.e. elements of the field
      are $\frac{f(X)}{g(X)}$ where
      $f,g \in \mathbb{F}_p\left[X\right]$. It's not perfect because
      $Im\left(F_p\right) = \mathbb{F}_p\left(X^p\right) \ne
      \mathbb{F}_p\left(X\right)$ \label{ex:lec3_notperfect}
  \end{enumerate}
  \label{ex:lec3_1}
\end{example}

\begin{theorem}
  $K$ is a \mynameref{def:perfectfield} if and only if all irreducible
  polynomial over $K$ 
  are separable or in other words all
  \mynameref{def:algebraicextension}s of $K$ are separable. 
  \begin{proof}
    Let $K$ is perfect and $P \in K\left[X\right]$ is an irreducible
    polynomial. Let also
    \[
    P\left(X\right) = Q\left(X^{p^r}\right) =
    \sum_i a_i \left(X^{p^r}\right)^i
    \]
    but as soon as my field is perfect then I can extract $p$-root of
    $a_i$
    \footnote {
      The root $b_i$ is a root of the following equation $X^p - a_i$
      i.e. $b_i^p -a_i = 0$ or $a_i = F_p\left(b_i\right)$.      
    }
    and do it repeatedly. I.e. $\exists b_i \in K$ such that
    $b_i^{p^r} = a_i$. Therefore
    \[
    P\left(X\right) =
    \sum_i b_i^{p^r} \left(X^{p^r}\right)^i =
    \sum_i \left(b_i X^i\right)^{p^r} =
    \left( \sum_i b_i X^i\right)^{p^r}.
    \]
    The polynomial is not irreducible unless $r=0$
    \footnote{
      In other case each root will have at least multiplicity $p^r$.
    } so irreducible means separable.

    If $K$ is not perfect but all irreducible polynomial are
    separable. $K$ is not perfect means that $\exists a \notin
    Im\left(F_p\right)$ and lets consider the following polynomial:
    $X^{p^r} - a$. It is irreducible and not separable.

    About separability:
    in fact all roots are in $\bar{K}$ are
    the same $x$ with $x^{p^r} = a$
    \footnote{
      We have $x^{p^r} = a$ thus polynomial
      $X^{p^r} - a$ can be written as
      $X^{p^r} - a = X^{p^r} - x^{p^r} = \left(X - x\right)^{p^r}$
      thus $x$ has multiplicity $p^r$
    }
    and of course
    $x^{p^{r-1}} \notin K$.
    \footnote{
      as soon as any power of $x$ (little $x$ but not the big one $X$)
    }

    About the polynomial is irreducible.
    We have already seen that in the case
    $\left[K\left(x\right): K\right] = p^r$ so the polynomial is
    irreducible
    \footnote {
      Corollary \ref{cor:lec3_1} says that there exists an irreducible
      polynomial of degree $p^r$ with $x$ as the root. Theorem
      \ref{thm:irreduciblediv} says that the polynomial should divide
      our polynomial $X^{p^r} -a$ as soon as they have the same
      root. The two polynomial have same degree and as result they are
      the same (up to a constant). Therefore the considered polynomial
      is irreducible.
    }
    and this finishes 
    \footnote{
      Because we found an irreducible polynomial that is not
      separable because has a root of multiplicity $p^r$
    }
    the proof.
  \end{proof}
  \label{thm:lec3_4}
\end{theorem}
